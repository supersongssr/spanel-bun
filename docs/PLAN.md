 SPanel å‰åç«¯åˆ†ç¦»å®Œæ•´å®æ–½æ–¹æ¡ˆ

 é¡¹ç›®æ¦‚è§ˆ

 ç›®æ ‡ï¼šå°† <.links/spanel> ä»PHPå•ä½“åº”ç”¨é‡æ„ä¸ºç°ä»£åŒ–çš„å‰åç«¯åˆ†ç¦»æ¶æ„

 æŠ€æœ¯é€‰å‹ï¼š
 - åç«¯ï¼šBun + TypeScript + Hono/Elysia
 - å‰ç«¯ï¼šVue 3 + Viteï¼ˆå¤šé¡µé¢MPAæ¨¡å¼ï¼‰
    - å‰ç«¯å°† user å’Œ admin é¢æ¿è¿›è¡Œå¯ä»¥åˆ†ç¦»éƒ¨ç½². éœ€è¦çº¯é™æ€ html . å¯ä»¥ç›´æ¥åœ¨ nginx éƒ¨ç½².
 - æ•°æ®åº“ï¼šMySQL/MariaDBï¼ˆä¿æŒä¸å˜ï¼‰
 - ORMï¼šPrisma ORM
 - è®¤è¯ï¼šJWT (Hono/JWT)

 ---
 ä¸€ã€æ¶æ„è®¾è®¡

 1.1 æ•´ä½“æ¶æ„

 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                    å‰ç«¯å±‚ï¼ˆVue 3 + Viteï¼‰                â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚   ç”¨æˆ·ç«¯ï¼ˆå¤šé¡µé¢ï¼‰  â”‚      ç®¡ç†ç«¯ï¼ˆå¯é€‰SPAï¼‰              â”‚
 â”‚                   â”‚                                     â”‚
 â”‚ - index.html      â”‚  - admin.html (å•é¡µ)                â”‚
 â”‚ - login.html      â”‚  - Vue Routerè·¯ç”±                   â”‚
 â”‚ - register.html   â”‚  - Element Plus UI                  â”‚
 â”‚ - node.html       â”‚                                     â”‚
 â”‚ - shop.html       â”‚                                     â”‚
 â”‚ - ticket.html     â”‚                                     â”‚
 â”‚ - profile.html    â”‚                                     â”‚
 â”‚ - ç­‰ç‹¬ç«‹é¡µé¢       â”‚                                     â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚              APIç½‘å…³ï¼ˆNginxåå‘ä»£ç†ï¼‰                    â”‚
 â”‚          /api/* â†’ Bunåç«¯ (ç«¯å£3000)                    â”‚
 â”‚          /user/* â†’ ç”¨æˆ·ç«¯é™æ€é¡µé¢ (ç«¯å£5173)            â”‚
 â”‚          /admin/* â†’ ç®¡ç†ç«¯é™æ€é¡µé¢ (ç«¯å£5174)           â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚              åç«¯å±‚ï¼ˆBun + TypeScriptï¼‰                 â”‚
 â”‚              Hono/Elysia Framework                      â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚ Controllerå±‚ â†’ Serviceå±‚ â†’ Modelå±‚ï¼ˆPrismaï¼‰           â”‚
 â”‚                                                        â”‚
 â”‚ - AuthController    - UserService          - User      â”‚
 â”‚ - NodeController    - NodeService          - Node      â”‚
 â”‚ - ShopController    - ShopService          - Shop      â”‚
 â”‚ - TicketController  - TicketService        - Ticket    â”‚
 â”‚ - AdminController   - AdminService         - ...       â”‚
 â”‚ - MuController      - TrafficService                   â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚              æ•°æ®å±‚ + å¤–éƒ¨æœåŠ¡                          â”‚
 â”‚  MySQL | Redis | TelegramBot | PaymentGateways          â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 1.2 ç›®å½•ç»“æ„è®¾è®¡

 spanel-frontend/                   # å‰ç«¯é¡¹ç›®ï¼ˆç”¨æˆ·ç«¯ + ç®¡ç†ç«¯ï¼‰
 â”œâ”€â”€ src/
 â”‚   â”œâ”€â”€ pages/                    # å¤šé¡µé¢å…¥å£
 â”‚   â”‚   â”œâ”€â”€ index/               # é¦–é¡µ
 â”‚   â”‚   â”‚   â”œâ”€â”€ App.vue
 â”‚   â”‚   â”‚   â”œâ”€â”€ main.ts
 â”‚   â”‚   â”‚   â””â”€â”€ components/
 â”‚   â”‚   â”œâ”€â”€ login/               # ç™»å½•é¡µ
 â”‚   â”‚   â”œâ”€â”€ register/            # æ³¨å†Œé¡µ
 â”‚   â”‚   â”œâ”€â”€ node/                # èŠ‚ç‚¹é¡µ
 â”‚   â”‚   â”œâ”€â”€ shop/                # å•†åº—é¡µ
 â”‚   â”‚   â”œâ”€â”€ ticket/              # å·¥å•é¡µ
 â”‚   â”‚   â””â”€â”€ profile/             # èµ„æ–™é¡µ
 â”‚   â”œâ”€â”€ admin/                   # ç®¡ç†ç«¯ï¼ˆå¯é€‰SPAï¼‰
 â”‚   â”‚   â”œâ”€â”€ App.vue
 â”‚   â”‚   â”œâ”€â”€ main.ts
 â”‚   â”‚   â”œâ”€â”€ router/
 â”‚   â”‚   â””â”€â”€ views/
 â”‚   â”œâ”€â”€ shared/                  # å…±äº«ä»£ç 
 â”‚   â”‚   â”œâ”€â”€ api/                 # APIå®¢æˆ·ç«¯
 â”‚   â”‚   â”œâ”€â”€ composables/         # ç»„åˆå¼å‡½æ•°
 â”‚   â”‚   â”œâ”€â”€ stores/              # çŠ¶æ€ç®¡ç†
 â”‚   â”‚   â”œâ”€â”€ types/               # TypeScriptç±»å‹
 â”‚   â”‚   â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
 â”‚   â””â”€â”€ assets/                  # é™æ€èµ„æº
 â”œâ”€â”€ public/
 â”œâ”€â”€ vite.config.ts               # Viteé…ç½®ï¼ˆå¤šé¡µé¢ï¼‰
 â””â”€â”€ package.json

 spanel-backend/                   # åç«¯é¡¹ç›®ï¼ˆBun + TypeScriptï¼‰
 â”œâ”€â”€ src/
 â”‚   â”œâ”€â”€ controllers/             # æ§åˆ¶å™¨å±‚
 â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
 â”‚   â”‚   â”œâ”€â”€ user.controller.ts
 â”‚   â”‚   â”œâ”€â”€ node.controller.ts
 â”‚   â”‚   â”œâ”€â”€ admin.controller.ts
 â”‚   â”‚   â””â”€â”€ mu.controller.ts
 â”‚   â”œâ”€â”€ services/                # ä¸šåŠ¡é€»è¾‘å±‚
 â”‚   â”‚   â”œâ”€â”€ auth.service.ts
 â”‚   â”‚   â”œâ”€â”€ user.service.ts
 â”‚   â”‚   â”œâ”€â”€ node.service.ts
 â”‚   â”‚   â”œâ”€â”€ payment.service.ts
 â”‚   â”‚   â””â”€â”€ traffic.service.ts
 â”‚   â”œâ”€â”€ models/                  # Prismaç”Ÿæˆçš„æ¨¡å‹
 â”‚   â”‚   â””â”€â”€ schema.prisma        # æ•°æ®åº“Schema
 â”‚   â”œâ”€â”€ middleware/              # ä¸­é—´ä»¶
 â”‚   â”‚   â”œâ”€â”€ auth.middleware.ts
 â”‚   â”‚   â”œâ”€â”€ admin.middleware.ts
 â”‚   â”‚   â”œâ”€â”€ cors.middleware.ts
 â”‚   â”‚   â””â”€â”€ ratelimit.middleware.ts
 â”‚   â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
 â”‚   â”‚   â”œâ”€â”€ jwt.ts
 â”‚   â”‚   â”œâ”€â”€ hash.ts
 â”‚   â”‚   â””â”€â”€ telegram.ts
 â”‚   â”œâ”€â”€ types/                   # TypeScriptç±»å‹
 â”‚   â””â”€â”€ index.ts                 # å…¥å£æ–‡ä»¶
 â”œâ”€â”€ prisma/
 â”‚   â””â”€â”€ schema.prisma            # Prisma Schema
 â”œâ”€â”€ tests/                       # æµ‹è¯•æ–‡ä»¶
 â”œâ”€â”€ docker-compose.yml           # Dockeré…ç½®
 â”œâ”€â”€ Dockerfile
 â””â”€â”€ package.json

 ---
 äºŒã€æŠ€æœ¯æ ˆè¯¦è§£

 2.1 åç«¯æŠ€æœ¯æ ˆ

 æ¡†æ¶é€‰æ‹©ï¼šHono vs Elysia

 æˆ‘æ¨èä½¿ç”¨ Honoï¼Œç†ç”±ï¼š
 - âœ… æ€§èƒ½æå…¶ä¼˜ç§€ï¼ˆæ¯”Fastifyæ›´å¿«ï¼‰
 - âœ… TypeScriptä¼˜å…ˆè®¾è®¡
 - âœ… APIè®¾è®¡ä¼˜é›…ï¼ˆç±»ä¼¼Expressï¼‰
 - âœ… æ”¯æŒBunåŸç”Ÿè¿è¡Œ
 - âœ… ä¸­é—´ä»¶ç”Ÿæ€ä¸°å¯Œ
 - âœ… æ”¯æŒå¤šç§è¿è¡Œæ—¶ï¼ˆBun/Node/Denoï¼‰

 æ ¸å¿ƒä¾èµ–ï¼š
 {
   "dependencies": {
     "hono": "^3.x",
     "@hono/jwt": "^1.x",
     "@hono/zod-validator": "^0.1.x",
     "prisma": "^5.x",
     "@prisma/client": "^5.x",
     "ioredis": "^5.x",
     "bcrypt": "^5.x",
     "nodemailer": "^6.x",
     "telegraf": "^4.x"  // Telegram Bot
   }
 }

 æ•°æ®åº“è¿ç§»ï¼ˆPHP Eloquent â†’ Prismaï¼‰ï¼š

 | PHP Model  | Prisma Model             |
 |------------|--------------------------|
 | User       | model User { ... }       |
 | Node       | model Node { ... }       |
 | Shop       | model Shop { ... }       |
 | TrafficLog | model TrafficLog { ... } |
 | ...        | ...                      |

 2.2 å‰ç«¯æŠ€æœ¯æ ˆ

 æ¡†æ¶ï¼šVue 3.3+ (Composition API + <script setup>)
 æ„å»ºå·¥å…·ï¼šVite 5.x
 è¯­è¨€ï¼šTypeScript

 ç”¨æˆ·ç«¯ï¼ˆå¤šé¡µé¢MPAï¼‰ï¼š
 - é¦–å±åŠ è½½å¿«ï¼ˆæ¯ä¸ªé¡µé¢ç‹¬ç«‹æ‰“åŒ…ï¼‰
 - æŒ‰éœ€åŠ è½½ï¼ˆåªåŠ è½½å½“å‰é¡µé¢éœ€è¦çš„èµ„æºï¼‰
 - SEOå‹å¥½
 - ç¼“å­˜ç­–ç•¥çµæ´»

 ç®¡ç†ç«¯ï¼ˆå¯é€‰SPAï¼‰ï¼š
 - å•é¡µåº”ç”¨ä½“éªŒæ›´å¥½
 - é¡µé¢åˆ‡æ¢æ— åˆ·æ–°
 - é€‚åˆé¢‘ç¹åˆ‡æ¢çš„ç®¡ç†åœºæ™¯

 æ ¸å¿ƒä¾èµ–ï¼š
 {
   "dependencies": {
     "vue": "^3.3.x",
     "vue-router": "^4.x",
     "pinia": "^2.x",
     "axios": "^1.x",
     "@element-plus/icons-vue": "^2.x",
     "element-plus": "^2.x"  // ç”¨æˆ·ç«¯
     // æˆ– "ant-design-vue": "^4.x"  // ç®¡ç†ç«¯
   }
 }

 Viteå¤šé¡µé¢é…ç½®ç¤ºä¾‹ï¼š
 // vite.config.ts
 import { defineConfig } from 'vite'
 import { resolve } from 'path'

 export default defineConfig({
   build: {
     rollupOptions: {
       input: {
         index: resolve(__dirname, 'src/pages/index/index.html'),
         login: resolve(__dirname, 'src/pages/login/index.html'),
         node: resolve(__dirname, 'src/pages/node/index.html'),
         // ... å…¶ä»–é¡µé¢
       }
     }
   }
 })

 ---
 ä¸‰ã€å®æ–½è®¡åˆ’ï¼ˆ3-4ä¸ªæœˆï¼‰

 ç¬¬1ä¸ªæœˆï¼šåŸºç¡€æ¶æ„æ­å»º

 ç¬¬1å‘¨ï¼šç¯å¢ƒå‡†å¤‡ä¸é¡¹ç›®åˆå§‹åŒ–

 - æ­å»ºå¼€å‘ç¯å¢ƒï¼ˆBunã€Node.jsã€æ•°æ®åº“ï¼‰
 - åˆå§‹åŒ–Gitä»“åº“
 - é…ç½®Dockerå¼€å‘ç¯å¢ƒ
 - è®¾è®¡æ•°æ®åº“Schemaï¼ˆPrismaï¼‰
 - åˆ›å»ºåŸºç¡€é¡¹ç›®ç»“æ„

 è¾“å‡ºç‰©ï¼š
 - Docker Composeé…ç½®
 - Prisma Schemaåˆç¨¿
 - é¡¹ç›®éª¨æ¶ä»£ç 

 ç¬¬2å‘¨ï¼šåç«¯åŸºç¡€æ¡†æ¶

 - æ­å»ºHonoæœåŠ¡å™¨
 - é…ç½®Prismaè¿æ¥æ•°æ®åº“
 - å®ç°JWTè®¤è¯ä¸­é—´ä»¶
 - å®ç°CORSä¸­é—´ä»¶
 - å®ç°æ—¥å¿—ä¸­é—´ä»¶
 - ç¼–å†™åŸºç¡€APIè§„èŒƒ

 å…³é”®æ–‡ä»¶ï¼š
 - src/index.ts - æœåŠ¡å™¨å…¥å£
 - src/middleware/auth.middleware.ts
 - src/utils/jwt.ts

 ç¬¬3å‘¨ï¼šç”¨æˆ·è®¤è¯æ¨¡å—

 - å®ç°æ³¨å†ŒAPI
 - å®ç°ç™»å½•APIï¼ˆJWTï¼‰
 - å®ç°ç™»å‡ºAPI
 - å®ç°å¯†ç é‡ç½®API
 - é›†æˆé‚®ä»¶å‘é€æœåŠ¡
 - é›†æˆéªŒè¯ç æœåŠ¡ï¼ˆreCAPTCHA/GeoTestï¼‰

 APIåˆ—è¡¨ï¼š
 POST /api/auth/register
 POST /api/auth/login
 POST /api/auth/logout
 POST /api/auth/reset-password
 POST /api/auth/send-verification

 ç¬¬4å‘¨ï¼šå‰ç«¯åŸºç¡€æ¡†æ¶

 - é…ç½®Viteå¤šé¡µé¢æ„å»º
 - æ­å»ºVue 3é¡¹ç›®ç»“æ„
 - å°è£…Axios APIå®¢æˆ·ç«¯
 - å®ç°JWT Tokenç®¡ç†
 - å®ç°è·¯ç”±å®ˆå«
 - æ­å»ºç»„ä»¶åº“ï¼ˆElement Plusï¼‰

 å…³é”®æ–‡ä»¶ï¼š
 - src/shared/api/client.ts
 - src/shared/composables/useAuth.ts
 - vite.config.ts

 ç¬¬2ä¸ªæœˆï¼šæ ¸å¿ƒåŠŸèƒ½å¼€å‘

 ç¬¬5-6å‘¨ï¼šç”¨æˆ·ç«¯æ ¸å¿ƒé¡µé¢

 ç¬¬5å‘¨ï¼šåŸºç¡€é¡µé¢
 - ç™»å½•é¡µé¢ï¼ˆ/loginï¼‰
 - æ³¨å†Œé¡µé¢ï¼ˆ/registerï¼‰
 - é¦–é¡µï¼ˆ/ï¼‰
 - ç”¨æˆ·èµ„æ–™é¡µï¼ˆ/profileï¼‰

 ç¬¬6å‘¨ï¼šä¸šåŠ¡é¡µé¢
 - èŠ‚ç‚¹åˆ—è¡¨é¡µï¼ˆ/nodeï¼‰
 - è®¢é˜…ç®¡ç†é¡µï¼ˆ/subscribeï¼‰
 - å·¥å•ç³»ç»Ÿé¡µï¼ˆ/ticketï¼‰

 æŠ€æœ¯è¦ç‚¹ï¼š
 - æ¯ä¸ªé¡µé¢ç‹¬ç«‹å…¥å£
 - é¦–å±åŠ è½½ä¼˜åŒ–ï¼ˆ< 1sï¼‰
 - å“åº”å¼è®¾è®¡ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰
 - SSR/SSGä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

 ç¬¬7-8å‘¨ï¼šåç«¯ä¸šåŠ¡é€»è¾‘

 ç¬¬7å‘¨ï¼šç”¨æˆ·ä¸èŠ‚ç‚¹æ¨¡å—
 - ç”¨æˆ·ä¿¡æ¯API
 - èŠ‚ç‚¹åˆ—è¡¨API
 - èŠ‚ç‚¹è¯¦æƒ…API
 - æµé‡ç»Ÿè®¡API
 - åœ¨çº¿ç”¨æˆ·API

 ç¬¬8å‘¨ï¼šå•†åº—ä¸æ”¯ä»˜æ¨¡å—
 - å•†åº—åˆ—è¡¨API
 - è´­ä¹°å•†å“API
 - æ”¯ä»˜å›è°ƒå¤„ç†
 - è®¢å•ç®¡ç†API
 - é‚€è¯·ç³»ç»ŸAPI

 APIåˆ—è¡¨ï¼š
 GET  /api/user/info
 GET  /api/user/nodes
 GET  /api/user/subscribe
 GET  /api/user/traffic
 GET  /api/shop/list
 POST /api/shop/purchase
 POST /api/payment/callback

 ç¬¬3ä¸ªæœˆï¼šé«˜çº§åŠŸèƒ½ä¸ç®¡ç†ç«¯

 ç¬¬9-10å‘¨ï¼šç®¡ç†ç«¯å¼€å‘

 æ–¹æ¡ˆAï¼šSPAæ¨¡å¼
 - æ­å»ºVue Routerè·¯ç”±
 - ç”¨æˆ·ç®¡ç†é¡µé¢
 - èŠ‚ç‚¹ç®¡ç†é¡µé¢
 - ç³»ç»Ÿé…ç½®é¡µé¢
 - æ”¯ä»˜ç®¡ç†é¡µé¢
 - æ•°æ®ç»Ÿè®¡Dashboard

 æ–¹æ¡ˆBï¼šå¤šé¡µé¢æ¨¡å¼ï¼ˆä¸ç”¨æˆ·ç«¯ä¸€è‡´ï¼‰
 - ç®¡ç†å‘˜ç™»å½•ï¼ˆ/admin/loginï¼‰
 - ç®¡ç†é¦–é¡µï¼ˆ/adminï¼‰
 - ç”¨æˆ·ç®¡ç†ï¼ˆ/admin/userï¼‰
 - èŠ‚ç‚¹ç®¡ç†ï¼ˆ/admin/nodeï¼‰
 - ç³»ç»Ÿè®¾ç½®ï¼ˆ/admin/configï¼‰

 æ¨èï¼šç®¡ç†ç«¯ä½¿ç”¨SPAï¼Œä½“éªŒæ›´å¥½ã€‚

 ç¬¬11-12å‘¨ï¼šèŠ‚ç‚¹é€šä¿¡ä¸Muæ¨¡å—

 Mu APIæ˜¯èŠ‚ç‚¹ä¸åç«¯é€šä¿¡çš„æ ¸å¿ƒï¼š

 GET  /mu/users              # è·å–ç”¨æˆ·åˆ—è¡¨
 GET  /mu/users/:id/traffic  # ä¸ŠæŠ¥ç”¨æˆ·æµé‡
 GET  /mu/nodes/:id/info     # è·å–èŠ‚ç‚¹ä¿¡æ¯
 POST /mu/nodes/:id/online   # ä¸ŠæŠ¥åœ¨çº¿äººæ•°

 å…³é”®ç‚¹ï¼š
 - æ€§èƒ½ä¼˜åŒ–ï¼ˆèŠ‚ç‚¹é«˜é¢‘è¯·æ±‚ï¼‰
 - ç¼“å­˜ç­–ç•¥ï¼ˆRedisï¼‰
 - å¹¶å‘å¤„ç†
 - TokenéªŒè¯ï¼ˆmuKeyï¼‰

 ç¬¬4ä¸ªæœˆï¼šæµ‹è¯•ã€ä¼˜åŒ–ã€éƒ¨ç½²

 ç¬¬13å‘¨ï¼šæµ‹è¯•ä¸ä¿®å¤

 - å•å…ƒæµ‹è¯•ï¼ˆVitest + Bun Testï¼‰
 - é›†æˆæµ‹è¯•
 - ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆPlaywrightï¼‰
 - æ€§èƒ½æµ‹è¯•
 - å®‰å…¨å®¡è®¡
 - Bugä¿®å¤

 ç¬¬14å‘¨ï¼šæ€§èƒ½ä¼˜åŒ–

 - å‰ç«¯é¦–å±ä¼˜åŒ–
 - APIå“åº”ä¼˜åŒ–
 - æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
 - Redisç¼“å­˜ä¼˜åŒ–
 - CDNé…ç½®
 - Gzipå‹ç¼©

 ç¬¬15å‘¨ï¼šéƒ¨ç½²ä¸æ–‡æ¡£

 - Dockeré•œåƒæ„å»º
 - Nginxé…ç½®
 - CI/CDæµç¨‹
 - APIæ–‡æ¡£ï¼ˆSwagger/OpenAPIï¼‰
 - éƒ¨ç½²æ–‡æ¡£
 - ç”¨æˆ·æ‰‹å†Œ

 ç¬¬16å‘¨ï¼šä¸Šçº¿ä¸ç›‘æ§

 - ç°åº¦å‘å¸ƒ
 - ç›‘æ§å‘Šè­¦ï¼ˆSentryï¼‰
 - æ—¥å¿—åˆ†æ
 - æ€§èƒ½ç›‘æ§
 - ç”¨æˆ·åé¦ˆæ”¶é›†
 - è¿­ä»£ä¼˜åŒ–

 ---
 å››ã€å…³é”®æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ

 4.1 æ•°æ®åº“è¿ç§»ï¼ˆPHP â†’ Prismaï¼‰

 æŒ‘æˆ˜ï¼š30+ä¸ªModeléœ€è¦é‡å†™

 è§£å†³æ–¹æ¡ˆï¼š
 1. ä½¿ç”¨Prismaçš„introspectionåŠŸèƒ½è‡ªåŠ¨ç”ŸæˆSchema
 2. é€æ­¥è¿ç§»ï¼Œä¿æŒåŒå†™ï¼ˆPHP + TypeScriptï¼‰è¿‡æ¸¡æœŸ
 3. ä½¿ç”¨Prisma Migrateç®¡ç†ç‰ˆæœ¬

 ç¤ºä¾‹ï¼š
 # 1. ä»ç°æœ‰æ•°æ®åº“ç”ŸæˆSchema
 npx prisma db pull

 # 2. è°ƒæ•´ç”Ÿæˆçš„Schema
 # 3. åˆ›å»ºè¿ç§»
 npx prisma migrate dev --name init

 # 4. ç”Ÿæˆå®¢æˆ·ç«¯
 npx prisma generate

 4.2 æ”¯ä»˜ç³»ç»Ÿè¿ç§»

 æŒ‘æˆ˜ï¼šå¤šç§æ”¯ä»˜ç½‘å…³ï¼ˆæ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ç­‰ï¼‰

 è§£å†³æ–¹æ¡ˆï¼š
 - ä½¿ç”¨Node.jsç‰ˆæœ¬çš„æ”¯ä»˜SDK
 - ä¿æŒç›¸åŒçš„æ”¯ä»˜å›è°ƒé€»è¾‘
 - ç­¾åç®—æ³•ä¿æŒä¸€è‡´

 æ¨èåº“ï¼š
 // æ”¯ä»˜å®
 import AlipaySdk from 'alipay-sdk'

 // å¾®ä¿¡æ”¯ä»˜
 import WechatPay from 'wechatpay-axios-plugin'

 4.3 Telegram Boté›†æˆ

 å½“å‰ï¼šPHPä½¿ç”¨Telegram SDK
 è¿ç§»ï¼šä½¿ç”¨Telegrafï¼ˆNode.jsæœ€æµè¡Œçš„Telegram Botæ¡†æ¶ï¼‰

 import { Telegraf } from 'telegraf'

 const bot = new Telegraf(process.env.BOT_TOKEN)
 bot.command('start', (ctx) => ctx.reply('Hello'))
 bot.launch()

 4.4 Sessionç®¡ç†

 å½“å‰ï¼šPHP Session
 è¿ç§»åï¼šJWT + Redis

 // ç”ŸæˆJWT
 const token = await sign(payload, secret)

 // å­˜å‚¨åˆ°Redis
 await redis.set(`user:${userId}`, token, 'EX', 7 * 24 * 3600)

 // éªŒè¯JWT
 const payload = await verify(token, secret)

 4.5 å‰ç«¯å¤šé¡µé¢é¦–å±ä¼˜åŒ–

 ä¼˜åŒ–ç­–ç•¥ï¼š
 1. ä»£ç åˆ†å‰²ï¼šæ¯ä¸ªé¡µé¢ç‹¬ç«‹æ‰“åŒ…
 2. Tree Shakingï¼šç§»é™¤æœªä½¿ç”¨ä»£ç 
 3. å‹ç¼©ï¼šGzip + Brotli
 4. é¢„åŠ è½½ï¼š<link rel="modulepreload">
 5. CDNï¼šé™æ€èµ„æºCDNåŠ é€Ÿ
 6. HTTP/2ï¼šå¤šè·¯å¤ç”¨
 7. ç¼“å­˜ç­–ç•¥ï¼šå¼ºç¼“å­˜ + åå•†ç¼“å­˜

 ç›®æ ‡ï¼š
 - é¦–å±åŠ è½½ < 1sï¼ˆ4Gç½‘ç»œï¼‰
 - é¦–æ¬¡å†…å®¹ç»˜åˆ¶ï¼ˆFCPï¼‰< 0.5s
 - æœ€å¤§å†…å®¹ç»˜åˆ¶ï¼ˆLCPï¼‰< 1.5s

 4.6 æ€§èƒ½å¯¹æ¯”ï¼ˆPHP vs Bunï¼‰

 | æŒ‡æ ‡             | PHP 7.4 + Slim | Bun + Hono  |
 |------------------|----------------|-------------|
 | å¯åŠ¨æ—¶é—´         | ~500ms         | ~50ms       |
 | å†…å­˜å ç”¨         | ~50MB          | ~20MB       |
 | è¯·æ±‚å¤„ç†ï¼ˆç®€å•ï¼‰ | ~2000 req/s    | ~8000 req/s |
 | è¯·æ±‚å¤„ç†ï¼ˆå¤æ‚ï¼‰ | ~500 req/s     | ~2000 req/s |
 | å¹¶å‘è¿æ¥         | ~1000          | ~10000      |

 é¢„æœŸæå‡ï¼š3-4å€æ€§èƒ½æå‡

 ---
 äº”ã€éƒ¨ç½²æ–¹æ¡ˆ

 5.1 å¼€å‘ç¯å¢ƒ

 # docker-compose.yml
 version: '3.8'
 services:
   mysql:
     image: mysql:8.0
     environment:
       MYSQL_ROOT_PASSWORD: root
       MYSQL_DATABASE: spanel
     ports:
       - "3306:3306"
     volumes:
       - mysql_data:/var/lib/mysql

   redis:
     image: redis:7-alpine
     ports:
       - "6379:6379"

   backend:
     build: ./backend
     ports:
       - "3000:3000"
     depends_on:
       - mysql
       - redis
     environment:
       DATABASE_URL: mysql://root:root@mysql:3306/spanel
       REDIS_URL: redis://redis:6379
     volumes:
       - ./backend:/app

   frontend:
     build: ./frontend
     ports:
       - "5173:5173"
     volumes:
       - ./frontend:/app

 volumes:
   mysql_data:

 5.2 ç”Ÿäº§ç¯å¢ƒ

 æ¶æ„ï¼š
 Nginx (åå‘ä»£ç† + SSL)
   â”œâ”€â”€ /api/* â†’ Bunåç«¯ (ç«¯å£3000)
   â”œâ”€â”€ /user/* â†’ ç”¨æˆ·ç«¯é™æ€æ–‡ä»¶
   â”œâ”€â”€ /admin/* â†’ ç®¡ç†ç«¯é™æ€æ–‡ä»¶
   â””â”€â”€ /* â†’ é™æ€èµ„æºCDN

 Bunåç«¯ (PM2è¿›ç¨‹ç®¡ç†)
   â”œâ”€â”€ 4ä¸ªå®ä¾‹ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰
   â””â”€â”€ Redisä¼šè¯å­˜å‚¨

 MySQL (ä¸»ä»å¤åˆ¶)
 Redis (æŒä¹…åŒ–)

 Nginxé…ç½®ç¤ºä¾‹ï¼š
 server {
     listen 443 ssl http2;
     server_name spanel.example.com;

     ssl_certificate /path/to/cert.pem;
     ssl_certificate_key /path/to/key.pem;

     # APIä»£ç†
     location /api/ {
         proxy_pass http://localhost:3000;
         proxy_http_version 1.1;
         proxy_set_header Upgrade $http_upgrade;
         proxy_set_header Connection 'upgrade';
         proxy_set_header Host $host;
         proxy_cache_bypass $http_upgrade;
     }

     # ç”¨æˆ·ç«¯
     location /user/ {
         root /var/www/spannel-frontend/dist;
         try_files $uri $uri/ /index.html;
     }

     # ç®¡ç†ç«¯
     location /admin/ {
         root /var/www/spannel-frontend/dist;
         try_files $uri $uri/ /admin.html;
     }

     # é™æ€èµ„æº
     location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
         root /var/www/spannel-frontend/dist;
         expires 1y;
         add_header Cache-Control "public, immutable";
     }
 }

 ---
 å…­ã€é£é™©æ§åˆ¶

 6.1 æŠ€æœ¯é£é™©

 | é£é™©           | ç­‰çº§ | ç¼“è§£æªæ–½                               |
 |----------------|------|----------------------------------------|
 | Bunç”Ÿæ€ä¸æˆç†Ÿ  | ä¸­   | ä½¿ç”¨æˆç†Ÿçš„Honoæ¡†æ¶ï¼Œå…³é”®åŠŸèƒ½æœ‰å¤‡é€‰æ–¹æ¡ˆ |
 | æ•°æ®åº“è¿ç§»å¤±è´¥ | é«˜   | å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼Œä¿ç•™PHPç‰ˆæœ¬ä½œä¸ºå›é€€  |
 | æ€§èƒ½ä¸è¾¾é¢„æœŸ   | ä½   | Bunå·²éªŒè¯æœ‰3-4å€æ€§èƒ½æå‡               |
 | æ”¯ä»˜ç³»ç»Ÿé—®é¢˜   | é«˜   | ä½¿ç”¨æˆç†Ÿçš„æ”¯ä»˜SDKï¼Œå……åˆ†æµ‹è¯•            |
 | ç¬¬ä¸‰æ–¹åº“ä¸å…¼å®¹ | ä¸­   | é€‰æ‹©æ´»è·ƒç»´æŠ¤çš„åº“ï¼Œé¿å…å®éªŒæ€§åŠŸèƒ½       |

 6.2 æ—¶é—´é£é™©

 | é£é™©     | ç¼“è§£æªæ–½                   |
 |----------|----------------------------|
 | å·¥æœŸå»¶è¯¯ | é¢„ç•™2å‘¨ç¼“å†²æ—¶é—´            |
 | äººå‘˜å˜åŠ¨ | ä»£ç æ–‡æ¡£å®Œå–„ï¼ŒçŸ¥è¯†å…±äº«     |
 | éœ€æ±‚å˜æ›´ | é”å®šæ ¸å¿ƒåŠŸèƒ½ï¼Œæ¬¡è¦åŠŸèƒ½è¿­ä»£ |

 6.3 ä¸šåŠ¡é£é™©

 | é£é™©         | ç¼“è§£æªæ–½                       |
 |--------------|--------------------------------|
 | ç”¨æˆ·æ•°æ®ä¸¢å¤± | æ•°æ®åº“æ¯æ—¥å¤‡ä»½ï¼Œè¿ç§»å‰å…¨é‡å¤‡ä»½ |
 | æœåŠ¡ä¸­æ–­     | ç°åº¦å‘å¸ƒï¼Œä¿ç•™PHPç‰ˆæœ¬å¹¶è¡Œè¿è¡Œ  |
 | åŠŸèƒ½ç¼ºå¤±     | å¯¹ç…§ç°æœ‰åŠŸèƒ½æ¸…å•ï¼Œé€é¡¹éªŒè¯     |

 ---
 ä¸ƒã€æˆåŠŸæ ‡å‡†

 7.1 åŠŸèƒ½å®Œæ•´æ€§

 - âœ… æ‰€æœ‰ç°æœ‰åŠŸèƒ½100%è¿ç§»
 - âœ… ç”¨æˆ·ç«¯15+ä¸ªé¡µé¢å…¨éƒ¨å®ç°
 - âœ… ç®¡ç†ç«¯30+ä¸ªåŠŸèƒ½å…¨éƒ¨å®ç°
 - âœ… APIæ¥å£è¦†ç›–ç‡100%

 7.2 æ€§èƒ½æŒ‡æ ‡

 - âœ… é¦–å±åŠ è½½ < 1s
 - âœ… APIå“åº”æ—¶é—´ < 100ms (P95)
 - âœ… å¹¶å‘æ”¯æŒ > 1000 QPS
 - âœ… å†…å­˜å ç”¨ < 100MB (å•å®ä¾‹)

 7.3 ç¨³å®šæ€§

 - âœ… ç³»ç»Ÿå¯ç”¨æ€§ > 99.9%
 - âœ… é”™è¯¯ç‡ < 0.1%
 - âœ… æ— å†…å­˜æ³„æ¼
 - âœ… ä¼˜é›…é™çº§

 7.4 å®‰å…¨æ€§

 - âœ… SQLæ³¨å…¥é˜²æŠ¤
 - âœ… XSSé˜²æŠ¤
 - âœ… CSRFé˜²æŠ¤
 - âœ… JWTå®‰å…¨å­˜å‚¨
 - âœ… APIé™æµ
 - âœ… æ•æ„Ÿæ•°æ®åŠ å¯†

 ---
 å…«ã€åç»­ä¼˜åŒ–æ–¹å‘

 çŸ­æœŸï¼ˆä¸Šçº¿å1-2ä¸ªæœˆï¼‰

 - æ·»åŠ å•å…ƒæµ‹è¯•è¦†ç›–ï¼ˆç›®æ ‡80%+ï¼‰
 - æ€§èƒ½ç›‘æ§é›†æˆï¼ˆSentry/DataDogï¼‰
 - æ—¥å¿—åˆ†æï¼ˆELK/Lokiï¼‰
 - è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹

 ä¸­æœŸï¼ˆ3-6ä¸ªæœˆï¼‰

 - å¼•å…¥GraphQLï¼ˆå¯é€‰ï¼‰
 - å®æ—¶é€šçŸ¥ï¼ˆWebSocketï¼‰
 - ç§»åŠ¨ç«¯Appï¼ˆReact Native/Capacitorï¼‰
 - å¤šè¯­è¨€æ”¯æŒï¼ˆi18nï¼‰

 é•¿æœŸï¼ˆ6-12ä¸ªæœˆï¼‰

 - å¾®æœåŠ¡æ‹†åˆ†ï¼ˆèŠ‚ç‚¹é€šä¿¡ç‹¬ç«‹æœåŠ¡ï¼‰
 - æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆBullMQï¼‰
 - å…¨æ–‡æœç´¢ï¼ˆMeiliSearchï¼‰
 - CDNåŠ é€Ÿï¼ˆCloudFlareï¼‰

 ---
 ä¹ã€æ€»ç»“

 é¡¹ç›®äº®ç‚¹

 1. âœ… æ€§èƒ½æå‡3-4å€ï¼ˆBun vs PHPï¼‰
 2. âœ… é¦–å±åŠ è½½<1sï¼ˆå¤šé¡µé¢MPAï¼‰
 3. âœ… ç°ä»£åŒ–æŠ€æœ¯æ ˆï¼ˆTypeScript + Vue 3ï¼‰
 4. âœ… ç±»å‹å®‰å…¨ï¼ˆå…¨æ ˆTypeScriptï¼‰
 5. âœ… å¼€å‘ä½“éªŒæå‡ï¼ˆVite HMR + çƒ­é‡è½½ï¼‰

 å…³é”®æˆåŠŸå› ç´ 

 1. â­ å……åˆ†çš„å‰æœŸå‡†å¤‡ï¼ˆæ•°æ®åº“Schemaã€APIè®¾è®¡ï¼‰
 2. â­ åˆ†é˜¶æ®µå®æ–½ï¼ˆå…ˆæ ¸å¿ƒï¼Œåæ¬¡è¦ï¼‰
 3. â­ æŒç»­æµ‹è¯•ï¼ˆæ¯ä¸ªé˜¶æ®µéƒ½è¦æµ‹è¯•ï¼‰
 4. â­ å®Œå–„æ–‡æ¡£ï¼ˆä»£ç æ–‡æ¡£ + éƒ¨ç½²æ–‡æ¡£ï¼‰
 5. â­ é£é™©é¢„æ¡ˆï¼ˆå›é€€æ–¹æ¡ˆã€åº”æ€¥æ–¹æ¡ˆï¼‰

 æœ€ç»ˆå»ºè®®

 è¿™ä¸ªæ–¹æ¡ˆæ˜¯å¯è¡Œçš„ï¼Œä½†éœ€è¦æ³¨æ„ï¼š

 1. æ—¶é—´å……è£•ï¼š3-4ä¸ªæœˆè¶³å¤Ÿå®Œæˆ
 2. æŠ€æœ¯å‚¨å¤‡ï¼šå›¢é˜Ÿéœ€è¦ç†Ÿæ‚‰TypeScriptå’ŒVue 3
 3. é£é™©å¯æ§ï¼šå¯ä»¥ä¿ç•™PHPç‰ˆæœ¬å¹¶è¡Œè¿è¡Œ
 4. æ”¶ç›Šæ˜æ˜¾ï¼šæ€§èƒ½å¤§å¹…æå‡ï¼Œå¼€å‘æ•ˆç‡æé«˜

 å¼€å§‹å®æ–½å‰ï¼š
 - ç¡®ä¿æ•°æ®åº“è®¾è®¡å®Œæ•´ï¼ˆPrisma Schemaï¼‰
 - æ­å»ºå®Œæ•´çš„å¼€å‘ç¯å¢ƒï¼ˆDockerï¼‰
 - å‡†å¤‡æµ‹è¯•æ•°æ®
 - åˆ¶å®šè¯¦ç»†çš„æµ‹è¯•è®¡åˆ’

 ç¥é¡¹ç›®é¡ºåˆ©ï¼ğŸš€



âœ… å·²æ›´æ–°çš„å…³é”®å†…å®¹

  1. æ¶æ„ä¼˜åŒ– - å®Œå…¨çš„å‰åç«¯åˆ†ç¦»

  - âœ… å‰ç«¯ï¼šçº¯é™æ€HTML/CSS/JSï¼ŒNginxç›´æ¥æä¾›ï¼Œæ— éœ€Node.js
  - âœ… åç«¯ï¼šçº¯RESTful APIï¼Œåªè¿”å›JSONï¼Œä¸æ¸²æŸ“HTML
  - âœ… éƒ¨ç½²ï¼šå‰ç«¯ = é™æ€æ–‡ä»¶ï¼Œåç«¯ = Bunè¿›ç¨‹

  2. Hono vs Elysiaè¯¦ç»†å¯¹æ¯”

  | æ¡†æ¶   | æ¨è   | æ ¸å¿ƒä¼˜åŠ¿                                |
  |--------|--------|-----------------------------------------|
  | Hono   | â­æ¨è | æˆç†Ÿç¨³å®šã€ç”Ÿæ€ä¸°å¯Œã€7k+ starsã€æ–‡æ¡£å®Œå–„ |
  | Elysia | å¤‡é€‰   | ç±»å‹å®‰å…¨æ›´å¼ºã€è‡ªåŠ¨ç±»å‹æ¨æ–­ã€ä»£ç æ›´ç®€æ´  |

  3. éƒ¨ç½²æ–¹æ¡ˆç®€åŒ–

  - å‰ç«¯ï¼švite build â†’ ç”Ÿæˆdist/ â†’ å¤åˆ¶åˆ°Nginxç›®å½• âœ…
  - åç«¯ï¼šbun run src/index.ts â†’ PM2ç®¡ç†4ä¸ªå®ä¾‹ âœ…
  - Nginxï¼š
    - /api/* â†’ åå‘ä»£ç†åˆ°Bun (3000ç«¯å£)
    - / â†’ é™æ€æ–‡ä»¶æœåŠ¡

  4. æ ¸å¿ƒä¼˜åŠ¿

  - ğŸš€ æ€§èƒ½ï¼šå‰ç«¯é™æ€ç¼“å­˜ + åç«¯3-4å€æ€§èƒ½æå‡
  - ğŸ’° æˆæœ¬ï¼šå‰ç«¯å¯æ”¾CDN/OSSï¼Œåç«¯åªéœ€å°æœåŠ¡å™¨
  - ğŸ”§ ç»´æŠ¤ï¼šå‰åç«¯å®Œå…¨è§£è€¦ï¼Œç‹¬ç«‹å¼€å‘éƒ¨ç½²

  ç°åœ¨æ–¹æ¡ˆå·²ç»å®Œæ•´ï¼Œå¯ä»¥å¼€å§‹å®æ–½äº†ï¼
