var N=(b,d,c)=>new Promise((y,w)=>{var k=u=>{try{m(c.next(u))}catch(f){w(f)}},C=u=>{try{m(c.throw(u))}catch(f){w(f)}},m=u=>u.done?y(u.value):Promise.resolve(u.value).then(k,C);m((c=c.apply(b,d)).next())});import"../modulepreload-polyfill-B5Qt9EMX.js";import{v as R,r as S,c as F,l as O,ab as i,B as G,z as H,C as t,D as s,E as a,Q as n,u as l,R as _,at as J}from"../vue-vendor-k0iSlyGv.js";/* empty css               */import{n as U,u as B,a as K,o as W,s as X,c as Y,p as Z,q as $,r as tt,k as st,b as et,E as V,i as at,e as ot}from"../element-plus-0NBP0_0Z.js";import{b as x,j as q,e as T,h as lt,i as nt,s as dt}from"../router-guard-Df7N2WPS.js";import{_ as it}from"../_plugin-vue_export-helper-DlAUqK2U.js";const rt={class:"admin-dashboard-container"},ut={class:"header-content"},_t={class:"title"},ct={class:"user-info"},ft={class:"user-name"},mt={class:"stat-content"},pt={class:"stat-icon"},vt={class:"stat-info"},ht={class:"stat-value"},wt={class:"stat-extra"},gt={class:"stat-content"},bt={class:"stat-icon"},xt={class:"stat-info"},yt={class:"stat-value"},kt={class:"stat-extra"},Ct={class:"stat-content"},Et={class:"stat-icon"},At={class:"stat-info"},Bt={class:"stat-value"},Tt={class:"stat-content"},zt={class:"stat-icon"},Dt={class:"stat-info"},Nt={class:"stat-value"},St={class:"card-header"},Ut={class:"quick-actions"},Vt={class:"card-header"},qt=R({__name:"Dashboard",setup(b){const d=S({}),c=S(!1),y=F(()=>x.getUserName()||"Admin"),w=()=>N(this,null,function*(){var f;try{c.value=!0;const e=yield lt(nt.api.admin.stats.get());d.value=e,V.success("统计数据已刷新")}catch(e){console.error("Failed to fetch admin stats:",e),V.error(e.message||"获取统计数据失败"),(f=e.message)!=null&&f.includes("Authentication")&&x.logout()}finally{c.value=!1}}),k=()=>{w()},C=()=>{window.location.href="/admin/users.html"},m=()=>{window.location.href="/user/dashboard.html"},u=()=>{x.logout()};return O(()=>{if(q()){if(!x.isAdmin()){alert("需要管理员权限才能访问此页面"),window.location.href="/index.html";return}w()}}),(f,e)=>{const r=i("el-icon"),P=i("el-tag"),D=i("el-dropdown-item"),j=i("el-dropdown-menu"),M=i("el-dropdown"),I=i("el-header"),p=i("el-card"),v=i("el-col"),E=i("el-row"),A=i("el-button"),h=i("el-descriptions-item"),L=i("el-descriptions"),Q=i("el-main");return H(),G("div",rt,[t(I,{class:"admin-header"},{default:s(()=>[a("div",ut,[a("h1",_t,[t(r,null,{default:s(()=>[t(l(U))]),_:1}),e[0]||(e[0]=n(" 管理员控制台 ",-1))]),a("div",ct,[t(P,{type:"danger",size:"large"},{default:s(()=>[...e[1]||(e[1]=[n("管理员",-1)])]),_:1}),t(M,null,{dropdown:s(()=>[t(j,null,{default:s(()=>[t(D,{onClick:m},{default:s(()=>[t(r,null,{default:s(()=>[t(l(W))]),_:1}),e[2]||(e[2]=n(" 用户端面板 ",-1))]),_:1}),t(D,{divided:"",onClick:u},{default:s(()=>[t(r,null,{default:s(()=>[t(l(X))]),_:1}),e[3]||(e[3]=n(" 退出登录 ",-1))]),_:1})]),_:1})]),default:s(()=>[a("span",ft,[t(r,null,{default:s(()=>[t(l(B))]),_:1}),n(" "+_(y.value)+" ",1),t(r,{class:"el-icon--right"},{default:s(()=>[t(l(K))]),_:1})])]),_:1})])])]),_:1}),t(Q,{class:"admin-main"},{default:s(()=>[t(E,{gutter:20,class:"stats-cards"},{default:s(()=>[t(v,{xs:24,sm:12,md:6},{default:s(()=>[t(p,{class:"stat-card users"},{default:s(()=>{var o,g;return[a("div",mt,[a("div",pt,[t(r,null,{default:s(()=>[t(l(B))]),_:1})]),a("div",vt,[a("div",ht,_(((o=d.value.users)==null?void 0:o.total)||0),1),e[4]||(e[4]=a("div",{class:"stat-label"},"总用户数",-1)),a("div",wt," 今日新增: "+_(((g=d.value.users)==null?void 0:g.newToday)||0),1)])])]}),_:1})]),_:1}),t(v,{xs:24,sm:12,md:6},{default:s(()=>[t(p,{class:"stat-card nodes"},{default:s(()=>{var o,g;return[a("div",gt,[a("div",bt,[t(r,null,{default:s(()=>[t(l(Y))]),_:1})]),a("div",xt,[a("div",yt,_(((o=d.value.nodes)==null?void 0:o.total)||0),1),e[5]||(e[5]=a("div",{class:"stat-label"},"总节点数",-1)),a("div",kt," 在线: "+_(((g=d.value.nodes)==null?void 0:g.online)||0),1)])])]}),_:1})]),_:1}),t(v,{xs:24,sm:12,md:6},{default:s(()=>[t(p,{class:"stat-card upload"},{default:s(()=>{var o;return[a("div",Ct,[a("div",Et,[t(r,null,{default:s(()=>[t(l(Z))]),_:1})]),a("div",At,[a("div",Bt,_(l(T)(((o=d.value.traffic)==null?void 0:o.totalUpload)||0)),1),e[6]||(e[6]=a("div",{class:"stat-label"},"总上传流量",-1)),e[7]||(e[7]=a("div",{class:"stat-extra"}," 全站统计 ",-1))])])]}),_:1})]),_:1}),t(v,{xs:24,sm:12,md:6},{default:s(()=>[t(p,{class:"stat-card download"},{default:s(()=>{var o;return[a("div",Tt,[a("div",zt,[t(r,null,{default:s(()=>[t(l($))]),_:1})]),a("div",Dt,[a("div",Nt,_(l(T)(((o=d.value.traffic)==null?void 0:o.totalDownload)||0)),1),e[8]||(e[8]=a("div",{class:"stat-label"},"总下载流量",-1)),e[9]||(e[9]=a("div",{class:"stat-extra"}," 全站统计 ",-1))])])]}),_:1})]),_:1})]),_:1}),t(E,{gutter:20,class:"actions-section"},{default:s(()=>[t(v,{span:24},{default:s(()=>[t(p,null,{header:s(()=>[a("div",St,[t(r,null,{default:s(()=>[t(l(st))]),_:1}),e[10]||(e[10]=a("span",null,"快速操作",-1))])]),default:s(()=>[a("div",Ut,[t(A,{type:"primary",size:"large",onClick:C,icon:l(B)},{default:s(()=>[...e[11]||(e[11]=[n(" 用户管理 ",-1)])]),_:1},8,["icon"]),t(A,{type:"success",size:"large",onClick:k,icon:l(tt)},{default:s(()=>[...e[12]||(e[12]=[n(" 刷新统计 ",-1)])]),_:1},8,["icon"]),t(A,{size:"large",onClick:m,icon:l(U)},{default:s(()=>[...e[13]||(e[13]=[n(" 切换到用户端 ",-1)])]),_:1},8,["icon"])])]),_:1})]),_:1})]),_:1}),t(E,{gutter:20,class:"info-section"},{default:s(()=>[t(v,{span:24},{default:s(()=>[t(p,null,{header:s(()=>[a("div",Vt,[t(r,null,{default:s(()=>[t(l(et))]),_:1}),e[14]||(e[14]=a("span",null,"系统信息",-1))])]),default:s(()=>[t(L,{column:3,border:""},{default:s(()=>[t(h,{label:"系统版本"},{default:s(()=>[...e[15]||(e[15]=[n("SPanel Bun v1.0.0",-1)])]),_:1}),t(h,{label:"后端框架"},{default:s(()=>[...e[16]||(e[16]=[n("Elysia.js",-1)])]),_:1}),t(h,{label:"前端框架"},{default:s(()=>[...e[17]||(e[17]=[n("Vue 3 + Element Plus",-1)])]),_:1}),t(h,{label:"数据库"},{default:s(()=>[...e[18]||(e[18]=[n("MySQL (201 users)",-1)])]),_:1}),t(h,{label:"节点数量"},{default:s(()=>{var o;return[n(_(((o=d.value.nodes)==null?void 0:o.total)||0),1)]}),_:1}),t(h,{label:"总流量使用"},{default:s(()=>{var o;return[n(_(l(T)(((o=d.value.traffic)==null?void 0:o.totalTraffic)||0)),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}}),Pt=it(qt,[["__scopeId","data-v-0fb79ca4"]]);if(!q())throw new Error("User not authenticated or not admin");if(!require("@/shared/utils/auth").auth.isAdmin())throw alert("需要管理员权限才能访问此页面"),window.location.href="/index.html",new Error("Admin privileges required");const z=J(Pt);z.use(at);for(const[b,d]of Object.entries(ot))z.component(b,d);dt();z.mount("#app");
