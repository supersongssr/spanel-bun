var B=(D,v,f)=>new Promise((g,y)=>{var w=_=>{try{x(f.next(_))}catch(k){y(k)}},s=_=>{try{x(f.throw(_))}catch(k){y(k)}},x=_=>_.done?g(_.value):Promise.resolve(_.value).then(w,s);x((f=f.apply(D,v)).next())});import"../modulepreload-polyfill-B5Qt9EMX.js";import{v as _e,r as p,c as fe,l as pe,ab as o,ac as me,B as U,z as $,C as e,D as t,E as a,u as i,Q as d,R as r,M as ve,O as A,y as P,at as ye}from"../vue-vendor-k0iSlyGv.js";/* empty css               */import{f as be,u as he,a as ge,h as we,s as xe,c as Q,m as ke,g as Ce,j as Ne,r as Ve,k as Te,l as q,E as L,i as $e,e as ze}from"../element-plus-0NBP0_0Z.js";import{b as z,k as I,h as De,i as Ee,j as Le,s as Be}from"../router-guard-Df7N2WPS.js";import{_ as Ue}from"../_plugin-vue_export-helper-DlAUqK2U.js";const Ae={class:"nodes-container"},Ie={class:"header-content"},Re={class:"user-info"},je={class:"user-name"},Me={class:"stat-content"},Se={class:"stat-icon total"},Oe={class:"stat-info"},Fe={class:"stat-value"},Ge={class:"stat-content"},Pe={class:"stat-icon class"},Qe={class:"stat-info"},qe={class:"stat-value"},He={class:"stat-content"},Je={class:"stat-icon group"},Ke={class:"stat-info"},We={class:"stat-value"},Xe={class:"node-name"},Ye={key:0,class:"empty-state"},Ze={key:0,class:"node-detail"},et=_e({__name:"NodeList",setup(D){const v=p([]),f=p(!1),g=p(""),y=p(0),w=p(!1),s=p(null),x=p(0),_=p(0),k=p(""),j=fe(()=>{let u=v.value;if(g.value){const l=g.value.toLowerCase();u=u.filter(m=>{var c,N;return((c=m.name)==null?void 0:c.toLowerCase().includes(l))||((N=m.server)==null?void 0:N.toLowerCase().includes(l))})}return y.value>0&&(u=u.filter(l=>l.type===y.value)),u}),M=()=>B(this,null,function*(){var u;try{f.value=!0;const l=yield De(Ee.api.nodes.get());v.value=l.nodes||[],x.value=l.user_class||0,_.value=l.user_node_group||0,k.value=z.getUserName()||"User"}catch(l){console.error("Failed to fetch nodes:",l),L.error(l.message||"获取节点列表失败"),(u=l.message)!=null&&u.includes("Authentication")&&z.logout()}finally{f.value=!1}}),H=()=>{M(),L.success("节点列表已刷新")},J=u=>{s.value=u,w.value=!0},S=u=>({1:"primary",2:"success",11:"warning"})[u]||"info",O=u=>B(this,null,function*(){try{yield navigator.clipboard.writeText(u),L.success("已复制到剪贴板")}catch(l){L.error("复制失败")}}),K=()=>{if(!s.value)return;const u=`
节点名称: ${s.value.name}
服务器地址: ${s.value.server}
加密方式: ${s.value.method}
类型: ${I(s.value.type)}
流量倍率: ${s.value.traffic_rate}x
  `.trim();O(u)},W=()=>{window.location.href="/user/dashboard.html"},X=()=>{window.location.href="/user/dashboard.html"},Y=()=>{z.logout()};return pe(()=>{if(!z.isLoggedIn()){z.logout();return}M()}),(u,l)=>{var G;const m=o("el-button"),c=o("el-icon"),N=o("el-dropdown-item"),Z=o("el-dropdown-menu"),ee=o("el-dropdown"),te=o("el-header"),V=o("el-card"),C=o("el-col"),F=o("el-row"),le=o("el-input"),E=o("el-option"),ae=o("el-select"),b=o("el-table-column"),T=o("el-tag"),se=o("el-table"),oe=o("el-empty"),ne=o("el-main"),h=o("el-descriptions-item"),de=o("el-text"),ue=o("el-descriptions"),ie=o("el-alert"),re=o("el-dialog"),ce=me("loading");return $(),U("div",Ae,[e(te,{class:"nodes-header"},{default:t(()=>[a("div",Ie,[l[8]||(l[8]=a("h1",{class:"title"},"节点列表",-1)),a("div",Re,[e(m,{onClick:W,icon:i(be)},{default:t(()=>[...l[5]||(l[5]=[d("返回",-1)])]),_:1},8,["icon"]),e(ee,null,{dropdown:t(()=>[e(Z,null,{default:t(()=>[e(N,{onClick:X},{default:t(()=>[e(c,null,{default:t(()=>[e(i(we))]),_:1}),l[6]||(l[6]=d(" 仪表盘 ",-1))]),_:1}),e(N,{divided:"",onClick:Y},{default:t(()=>[e(c,null,{default:t(()=>[e(i(xe))]),_:1}),l[7]||(l[7]=d(" 退出登录 ",-1))]),_:1})]),_:1})]),default:t(()=>[a("span",je,[e(c,null,{default:t(()=>[e(i(he))]),_:1}),d(" "+r(k.value)+" ",1),e(c,{class:"el-icon--right"},{default:t(()=>[e(i(ge))]),_:1})])]),_:1})])])]),_:1}),e(ne,{class:"nodes-main"},{default:t(()=>[e(F,{gutter:20,class:"stats-cards"},{default:t(()=>[e(C,{xs:24,sm:8},{default:t(()=>[e(V,{class:"stat-card"},{default:t(()=>[a("div",Me,[a("div",Se,[e(c,null,{default:t(()=>[e(i(Q))]),_:1})]),a("div",Oe,[a("div",Fe,r(v.value.length),1),l[9]||(l[9]=a("div",{class:"stat-label"},"可用节点",-1))])])]),_:1})]),_:1}),e(C,{xs:24,sm:8},{default:t(()=>[e(V,{class:"stat-card"},{default:t(()=>[a("div",Ge,[a("div",Pe,[e(c,null,{default:t(()=>[e(i(ke))]),_:1})]),a("div",Qe,[a("div",qe,r(x.value),1),l[10]||(l[10]=a("div",{class:"stat-label"},"用户等级",-1))])])]),_:1})]),_:1}),e(C,{xs:24,sm:8},{default:t(()=>[e(V,{class:"stat-card"},{default:t(()=>[a("div",He,[a("div",Je,[e(c,null,{default:t(()=>[e(i(Ce))]),_:1})]),a("div",Ke,[a("div",We,r(_.value),1),l[11]||(l[11]=a("div",{class:"stat-label"},"节点组",-1))])])]),_:1})]),_:1})]),_:1}),e(V,{class:"filter-card"},{default:t(()=>[e(F,{gutter:20},{default:t(()=>[e(C,{xs:24,sm:8},{default:t(()=>[e(le,{modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=n=>g.value=n),placeholder:"搜索节点名称","prefix-icon":i(Ne),clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),e(C,{xs:24,sm:8},{default:t(()=>[e(ae,{modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=n=>y.value=n),placeholder:"节点类型",clearable:""},{default:t(()=>[e(E,{label:"全部",value:0}),e(E,{label:"Shadowsocks",value:1}),e(E,{label:"ShadowsocksR",value:2}),e(E,{label:"V2Ray",value:11})]),_:1},8,["modelValue"])]),_:1}),e(C,{xs:24,sm:8},{default:t(()=>[e(m,{type:"primary",onClick:H,icon:i(Ve)},{default:t(()=>[...l[12]||(l[12]=[d(" 刷新节点 ",-1)])]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1}),e(V,{class:"nodes-table-card"},{default:t(()=>[ve(($(),P(se,{data:j.value,stripe:"",style:{width:"100%"}},{default:t(()=>[e(b,{prop:"id",label:"ID",width:"80"}),e(b,{prop:"name",label:"节点名称","min-width":"200"},{default:t(({row:n})=>[a("div",Xe,[e(c,null,{default:t(()=>[e(i(Q))]),_:1}),a("span",null,r(n.name),1)])]),_:1}),e(b,{label:"类型",width:"150"},{default:t(({row:n})=>[e(T,{type:S(n.type),size:"small"},{default:t(()=>[d(r(i(I)(n.type)),1)]),_:2},1032,["type"])]),_:1}),e(b,{prop:"server",label:"服务器地址","min-width":"200"}),e(b,{prop:"traffic_rate",label:"流量倍率",width:"120",align:"center"},{default:t(({row:n})=>[e(T,{type:"info",size:"small"},{default:t(()=>[d(r(n.traffic_rate)+"x",1)]),_:2},1024)]),_:1}),e(b,{prop:"status",label:"状态",width:"120"},{default:t(({row:n})=>[e(T,{type:n.status==="available"?"success":"danger",size:"small"},{default:t(()=>[d(r(n.status==="available"?"可用":"不可用"),1)]),_:2},1032,["type"])]),_:1}),e(b,{label:"操作",width:"200",fixed:"right"},{default:t(({row:n})=>[e(m,{type:"primary",size:"small",onClick:lt=>J(n)},{default:t(()=>[e(c,null,{default:t(()=>[e(i(Te))]),_:1}),l[13]||(l[13]=d(" 连接 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ce,f.value]]),j.value.length===0&&!f.value?($(),U("div",Ye,[e(oe,{description:"暂无可用节点"})])):A("",!0)]),_:1})]),_:1}),e(re,{modelValue:w.value,"onUpdate:modelValue":l[4]||(l[4]=n=>w.value=n),title:(G=s.value)==null?void 0:G.name,width:"500px"},{footer:t(()=>[e(m,{onClick:l[3]||(l[3]=n=>w.value=!1)},{default:t(()=>[...l[15]||(l[15]=[d("关闭",-1)])]),_:1}),e(m,{type:"primary",onClick:K},{default:t(()=>[e(c,null,{default:t(()=>[e(i(q))]),_:1}),l[16]||(l[16]=d(" 复制配置 ",-1))]),_:1})]),default:t(()=>[s.value?($(),U("div",Ze,[e(ue,{column:1,border:""},{default:t(()=>[e(h,{label:"节点名称"},{default:t(()=>[d(r(s.value.name),1)]),_:1}),e(h,{label:"服务器地址"},{default:t(()=>[e(de,{class:"copy-text",onClick:l[2]||(l[2]=n=>O(s.value.server))},{default:t(()=>[d(r(s.value.server)+" ",1),e(c,null,{default:t(()=>[e(i(q))]),_:1})]),_:1})]),_:1}),e(h,{label:"加密方式"},{default:t(()=>[d(r(s.value.method),1)]),_:1}),e(h,{label:"节点类型"},{default:t(()=>[e(T,{type:S(s.value.type),size:"small"},{default:t(()=>[d(r(i(I)(s.value.type)),1)]),_:1},8,["type"])]),_:1}),e(h,{label:"流量倍率"},{default:t(()=>[d(r(s.value.traffic_rate)+"x ",1)]),_:1}),e(h,{label:"状态"},{default:t(()=>[e(T,{type:s.value.status==="available"?"success":"danger",size:"small"},{default:t(()=>[d(r(s.value.status==="available"?"可用":"不可用"),1)]),_:1},8,["type"])]),_:1}),s.value.info?($(),P(h,{key:0,label:"说明"},{default:t(()=>[d(r(s.value.info),1)]),_:1})):A("",!0)]),_:1}),e(ie,{type:"info",title:"配置提示",closable:!1,"show-icon":"",style:{"margin-top":"20px"}},{default:t(()=>[...l[14]||(l[14]=[a("p",null,"在您的客户端中添加此节点，使用上述配置信息连接。",-1),a("p",null,"点击服务器地址可快速复制。",-1)])]),_:1})])):A("",!0)]),_:1},8,["modelValue","title"])])}}}),tt=Ue(et,[["__scopeId","data-v-fd36fc20"]]);if(!Le())throw new Error("User not authenticated");const R=ye(tt);R.use($e);for(const[D,v]of Object.entries(ze))R.component(D,v);Be();R.mount("#app");
